<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Singe's Token Command Center</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        .header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid #e94560;
            margin-bottom: 30px;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { color: #a0a0a0; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.2s;
        }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-card h3 { color: #e94560; font-size: 0.9em; margin-bottom: 10px; }
        .stat-card .value { font-size: 2em; font-weight: bold; }
        .stat-card .sub { color: #888; font-size: 0.8em; margin-top: 5px; }
        .section {
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .section h2 {
            color: #e94560;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 15px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        th { color: #888; font-weight: 600; font-size: 0.85em; text-transform: uppercase; }
        tr:hover { background: rgba(255,255,255,0.02); }
        .model-select {
            background: #0f3460;
            color: #fff;
            border: 1px solid #e94560;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9em;
            cursor: pointer;
            width: 100%;
        }
        .model-select:focus { outline: 2px solid #e94560; }
        .cost-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
        }
        .cost-low { background: #2ecc71; color: #000; }
        .cost-med { background: #f39c12; color: #000; }
        .cost-high { background: #e74c3c; color: #fff; }
        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-ok { background: #2ecc71; }
        .status-error { background: #e74c3c; }
        .status-disabled { background: #888; }
        .btn {
            background: #e94560;
            color: #fff;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn:hover { background: #ff6b6b; transform: scale(1.02); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .save-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 52, 96, 0.95);
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            backdrop-filter: blur(10px);
            border-top: 2px solid #e94560;
            transform: translateY(100%);
            transition: transform 0.3s;
        }
        .save-bar.visible { transform: translateY(0); }
        .save-bar span { font-weight: 600; }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .comparison-card {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid transparent;
        }
        .comparison-card.active { border-color: #2ecc71; }
        .comparison-card h4 { color: #888; margin-bottom: 10px; }
        .comparison-card .price { font-size: 1.8em; font-weight: bold; }
        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: 1fr; }
            .comparison { grid-template-columns: 1fr; }
            table { font-size: 0.85em; }
            th, td { padding: 10px 8px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üêí Singe's Token Command Center</h1>
        <p>Monitor, manage, and optimize AI model usage across all agents</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <h3>üí∞ Today's Spend</h3>
            <div class="value" id="todaySpend">$0.00</div>
            <div class="sub">vs $5.20 yesterday</div>
        </div>
        <div class="stat-card">
            <h3>üìä Total Tokens Today</h3>
            <div class="value" id="todayTokens">0</div>
            <div class="sub">Input + Output</div>
        </div>
        <div class="stat-card">
            <h3>ü§ñ Active Agents</h3>
            <div class="value">8</div>
            <div class="sub">7 sub-agents + main</div>
        </div>
        <div class="stat-card">
            <h3>‚è∞ Cron Jobs</h3>
            <div class="value">27</div>
            <div class="sub">20 enabled, 7 disabled</div>
        </div>
    </div>

    <div class="section">
        <h2>üìà Cost Comparison</h2>
        <div class="comparison">
            <div class="comparison-card" id="currentCard">
                <h4>Current Configuration</h4>
                <div class="price" id="currentCost">~$2.50/day</div>
                <p style="color: #888; margin-top: 10px;">Mixed: Qwen for crons, Kimi for main</p>
            </div>
            <div class="comparison-card" id="optimizedCard">
                <h4>All Premium (Reference)</h4>
                <div class="price">~$8.50/day</div>
                <p style="color: #888; margin-top: 10px;">If everything used Opus/Sonnet</p>
            </div>
        </div>
        <p style="margin-top: 15px; color: #2ecc71;">üí° You're saving ~70% with smart model selection!</p>
    </div>

    <div class="section">
        <h2>ü§ñ AGENTS</h2>
        <table>
            <thead>
                <tr>
                    <th>Agent</th>
                    <th>Role</th>
                    <th>Current Model</th>
                    <th>Cost/M tokens</th>
                    <th>Change Model</th>
                </tr>
            </thead>
            <tbody id="agentsTable">
                <!-- Filled by JS -->
            </tbody>
        </table>
    </div>

    <div class="section">
        <h2>‚è∞ CRON JOBS</h2>
        <table>
            <thead>
                <tr>
                    <th>Job Name</th>
                    <th>Status</th>
                    <th>Schedule</th>
                    <th>Current Model</th>
                    <th>Est. Daily Cost</th>
                    <th>Change Model</th>
                </tr>
            </thead>
            <tbody id="cronsTable">
                <!-- Filled by JS -->
            </tbody>
        </table>
    </div>

    <div style="height: 100px;"></div>

    <div class="save-bar" id="saveBar">
        <span>‚ö° You have unsaved changes!</span>
        <button class="btn" onclick="saveChanges()">üíæ Save & Apply</button>
        <button class="btn" style="background: #444;" onclick="discardChanges()">‚ùå Discard</button>
    </div>

    <script>
        // Model pricing data
        const MODELS = {
            'qwen/qwen-2.5-7b-instruct': { name: 'Qwen2.5 7B', costIn: 0.04, costOut: 0.10, tier: 'low' },
            'openrouter/moonshotai/kimi-k2.5': { name: 'Kimi K2.5', costIn: 0.45, costOut: 2.20, tier: 'med' },
            'anthropic/claude-sonnet-4-20250514': { name: 'Claude Sonnet 4.5', costIn: 3.00, costOut: 15.00, tier: 'high' },
            'anthropic/claude-opus-4-5': { name: 'Claude Opus 4.5', costIn: 15.00, costOut: 75.00, tier: 'high' },
            'openrouter/google/gemini-3.1-pro-preview': { name: 'Gemini 3.1 Pro', costIn: 2.00, costOut: 12.00, tier: 'high' },
            'openrouter/anthropic/claude-opus-4': { name: 'Claude Opus 4', costIn: 15.00, costOut: 75.00, tier: 'high' },
            'openrouter/anthropic/claude-opus-4.6': { name: 'Claude Opus 4.6', costIn: 15.00, costOut: 75.00, tier: 'high' }
        };

        // Current config data (would come from API in real implementation)
        const agentsData = [
            { id: 'main', name: 'Singe', role: 'CEO Twin / Master', model: 'openrouter/moonshotai/kimi-k2.5' },
            { id: 'max', name: 'Max', role: 'CTO / Engineering', model: 'openrouter/moonshotai/kimi-k2.5' },
            { id: 'maya', name: 'Maya', role: 'CMO / Creative', model: 'openrouter/moonshotai/kimi-k2.5' },
            { id: 'arjun', name: 'Arjun', role: 'COO / Operations', model: 'openrouter/moonshotai/kimi-k2.5' },
            { id: 'artha', name: 'Artha', role: 'Finance / BD', model: 'openrouter/moonshotai/kimi-k2.5' },
            { id: 'remo', name: 'Remo', role: 'EA / Personal', model: 'openrouter/moonshotai/kimi-k2.5' },
            { id: 'vayu', name: 'Vayu', role: 'Alerts / Monitoring', model: 'openrouter/moonshotai/kimi-k2.5' },
            { id: 'creative', name: 'Kala', role: 'Creative Assistant', model: 'openrouter/moonshotai/kimi-k2.5' }
        ];

        const cronsData = [
            { id: 'email', name: 'Urgent Email Detection', model: 'qwen/qwen-2.5-7b-instruct', schedule: 'Every 30min', enabled: true, dailyCost: 0.005 },
            { id: 'unanswered', name: 'Unanswered Message Check', model: 'qwen/qwen-2.5-7b-instruct', schedule: 'Every 15min', enabled: true, dailyCost: 0.01 },
            { id: 'watchdog', name: 'Agent Watchdog - Cheeko Bot', model: 'qwen/qwen-2.5-7b-instruct', schedule: 'Every 15min', enabled: true, dailyCost: 0.01 },
            { id: 'morning', name: "Ravi's Mega Morning Brief", model: 'qwen/qwen-2.5-7b-instruct', schedule: '8:00 AM daily', enabled: true, dailyCost: 0.01 },
            { id: 'deepwork', name: 'Singe Deep Work Cycle', model: 'qwen/qwen-2.5-7b-instruct', schedule: '11:00 PM daily', enabled: true, dailyCost: 0.002 },
            { id: 'research', name: 'Singe Daily Research Report', model: 'qwen/qwen-2.5-7b-instruct', schedule: '2:00 PM daily', enabled: true, dailyCost: 0.01 },
            { id: 'standup', name: 'Daily Squad Standup', model: 'default', schedule: '9:00 AM daily', enabled: true, dailyCost: 0.05 },
            { id: 'backup', name: 'Google Drive Backup', model: 'qwen/qwen-2.5-7b-instruct', schedule: '2:00 AM daily', enabled: true, dailyCost: 0.002 },
            { id: 'speed', name: 'Internet Speed Logger', model: 'qwen/qwen-2.5-7b-instruct', schedule: '8AM,2PM,10PM', enabled: true, dailyCost: 0.005 },
            { id: 'brainsync', name: 'Daily Brain Sync', model: 'qwen/qwen-2.5-7b-instruct', schedule: '11:00 PM daily', enabled: true, dailyCost: 0.002 },
            { id: 'whoop-morn', name: 'WHOOP Morning', model: 'qwen/qwen-2.5-7b-instruct', schedule: '8:30 AM daily', enabled: true, dailyCost: 0.002 },
            { id: 'whoop-aft', name: 'WHOOP Afternoon', model: 'qwen/qwen-2.5-7b-instruct', schedule: '2:00 PM daily', enabled: true, dailyCost: 0.002 },
            { id: 'whoop-night', name: 'WHOOP Night', model: 'qwen/qwen-2.5-7b-instruct', schedule: '10:00 PM daily', enabled: true, dailyCost: 0.002 },
            { id: 'food-morn', name: 'Food Journal - Morning', model: 'qwen/qwen-2.5-7b-instruct', schedule: '8:00 AM daily', enabled: true, dailyCost: 0.002 },
            { id: 'food-lunch', name: 'Food Journal - Lunch', model: 'qwen/qwen-2.5-7b-instruct', schedule: '1:00 PM daily', enabled: true, dailyCost: 0.002 },
            { id: 'food-din', name: 'Food Journal - Dinner', model: 'qwen/qwen-2.5-7b-instruct', schedule: '7:00 PM daily', enabled: true, dailyCost: 0.002 },
            { id: 'git', name: 'Git Auto-Sync (Hourly)', model: 'qwen/qwen-2.5-7b-instruct', schedule: 'Every hour', enabled: true, dailyCost: 0.01 },
            { id: 'health', name: 'Platform Health Council', model: 'qwen/qwen-2.5-7b-instruct', schedule: '9AM Sundays', enabled: true, dailyCost: 0.002 },
            { id: 'security', name: 'Security Council (Nightly)', model: 'qwen/qwen-2.5-7b-instruct', schedule: '3:30 AM daily', enabled: true, dailyCost: 0.002 },
            { id: 'market', name: 'market-dip-alert', model: 'default', schedule: 'Weekdays', enabled: true, dailyCost: 0.03 }
        ];

        let changes = {};

        function renderAgents() {
            const tbody = document.getElementById('agentsTable');
            tbody.innerHTML = agentsData.map(agent => {
                const modelInfo = MODELS[agent.model] || { name: agent.model, costIn: 0, costOut: 0, tier: 'med' };
                const costBadge = `<span class="cost-badge cost-${modelInfo.tier}">$${modelInfo.costIn}/$${modelInfo.costOut}</span>`;
                
                return `
                    <tr data-type="agent" data-id="${agent.id}">
                        <td><strong>${agent.name}</strong></td>
                        <td>${agent.role}</td>
                        <td>${modelInfo.name}</td>
                        <td>${costBadge}</td>
                        <td>
                            <select class="model-select" onchange="onModelChange('agent', '${agent.id}', this.value)">
                                ${Object.entries(MODELS).map(([key, info]) => 
                                    `<option value="${key}" ${agent.model === key ? 'selected' : ''}>${info.name}</option>`
                                ).join('')}
                            </select>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function renderCrons() {
            const tbody = document.getElementById('cronsTable');
            tbody.innerHTML = cronsData.map(cron => {
                const modelInfo = MODELS[cron.model] || { name: 'Default (kimi)', costIn: 0.45, costOut: 2.20, tier: 'med' };
                const statusClass = cron.enabled ? 'status-ok' : 'status-disabled';
                const statusText = cron.enabled ? 'Enabled' : 'Disabled';
                const costBadge = `<span class="cost-badge cost-${modelInfo.tier}">$${cron.dailyCost.toFixed(3)}/day</span>`;
                
                return `
                    <tr data-type="cron" data-id="${cron.id}">
                        <td><strong>${cron.name}</strong></td>
                        <td><span class="status-dot ${statusClass}"></span>${statusText}</td>
                        <td>${cron.schedule}</td>
                        <td>${modelInfo.name}</td>
                        <td>${costBadge}</td>
                        <td>
                            <select class="model-select" onchange="onModelChange('cron', '${cron.id}', this.value)">
                                <option value="default" ${cron.model === 'default' ? 'selected' : ''}>Default (kimi-k2.5)</option>
                                ${Object.entries(MODELS).map(([key, info]) => 
                                    `<option value="${key}" ${cron.model === key ? 'selected' : ''}>${info.name}</option>`
                                ).join('')}
                            </select>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function onModelChange(type, id, newModel) {
            changes[`${type}:${id}`] = { type, id, model: newModel };
            document.getElementById('saveBar').classList.add('visible');
            updateCostPreview();
        }

        function updateCostPreview() {
            // Calculate new estimated daily cost
            let cronCost = cronsData.reduce((sum, c) => {
                const changeKey = `cron:${c.id}`;
                const model = changes[changeKey]?.model || c.model;
                const modelInfo = MODELS[model] || MODELS['openrouter/moonshotai/kimi-k2.5'];
                // Rough estimation: assume 1K tokens per run
                const runsPerDay = c.schedule.includes('30min') ? 32 : 
                                  c.schedule.includes('15min') ? 96 :
                                  c.schedule.includes('hour') ? 24 :
                                  c.schedule.includes('daily') ? 1 : 3;
                const costPerRun = (modelInfo.costIn + modelInfo.costOut * 2) / 1000; // 1K in, 2K out avg
                return sum + (costPerRun * runsPerDay);
            }, 0);

            document.getElementById('currentCost').textContent = `~$${cronCost.toFixed(2)}/day`;
        }

        async function saveChanges() {
            const btn = document.querySelector('#saveBar .btn');
            btn.disabled = true;
            btn.textContent = 'üíæ Saving...';

            try {
                // In real implementation, this would call the API
                console.log('Saving changes:', changes);
                
                // Simulate API call
                await new Promise(r => setTimeout(r, 1000));
                
                // Reset
                changes = {};
                document.getElementById('saveBar').classList.remove('visible');
                btn.textContent = 'üíæ Save & Apply';
                btn.disabled = false;
                
                alert('‚úÖ Changes saved successfully! Gateway will restart to apply.');
                
                // Reload to show updated state
                location.reload();
            } catch (err) {
                alert('‚ùå Error saving: ' + err.message);
                btn.textContent = 'üíæ Save & Apply';
                btn.disabled = false;
            }
        }

        function discardChanges() {
            changes = {};
            document.getElementById('saveBar').classList.remove('visible');
            renderAgents();
            renderCrons();
        }

        // Simulate token usage data
        function updateStats() {
            const spend = (Math.random() * 0.5 + 0.1).toFixed(2);
            const tokens = Math.floor(Math.random() * 50000 + 10000);
            document.getElementById('todaySpend').textContent = `$${spend}`;
            document.getElementById('todayTokens').textContent = tokens.toLocaleString();
        }

        // Initialize
        renderAgents();
        renderCrons();
        updateStats();
        setInterval(updateStats, 30000); // Update every 30s
    </script>
</body>
</html>